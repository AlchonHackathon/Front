{"ast":null,"code":"var _jsxFileName = \"/Users/fawwazhaziq/Downloads/SEProject-v3/SEProject/frontend/src/components/ReportPopUp.js\",\n  _s = $RefreshSig$();\nimport './styling/ReportPopUp.css';\nimport { formatDate } from '../utils/FormatDate';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReportPopUp = ({\n  studentName,\n  report,\n  isVisible,\n  closeFunction\n}) => {\n  _s();\n  const UPLOADS_URL = '/api/uploads';\n  const [currentFile, setCurrentFile] = useState(null);\n  useEffect(() => {\n    const controller = new AbortController();\n    const fetchFile = async fileId => {\n      try {\n        const response = await axios.get(`${UPLOADS_URL}/${fileId}`, {\n          signal: controller.signal\n        });\n        setCurrentFile(response.data.file);\n      } catch (error) {\n        if (axios.isCancel(error)) {\n          console.error(`Fetch file request cancelled`);\n        } else {\n          console.error(`Error getting file:`, error);\n        }\n      }\n    };\n    if (report.file) {\n      fetchFile(report.file);\n    } else {\n      setCurrentFile(null);\n    }\n    return () => {\n      controller.abort();\n    };\n  }, [report]);\n  const downloadFile = async fileId => {\n    try {\n      const response = await axios.get(`${UPLOADS_URL}/download/${fileId}`, {\n        responseType: 'blob'\n      });\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', response.headers['content-disposition'].split('=')[1]);\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } catch (error) {\n      console.error('Error downloading file: ', error);\n    }\n  };\n  const formattedDate = formatDate(report.createdAt);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `ReportOverlay ${isVisible ? 'visible' : 'hidden'}`,\n    id: \"reportOverlay\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"PopUp\",\n      id: \"popup\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"PopUpExitButton\",\n        id: \"popUpExitButton\",\n        onClick: () => closeFunction(),\n        children: \"X\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ReportWrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ReportDetails\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ReportDetailsHeader\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"ReportDetailsSender\",\n              children: `Progress report sent by ${studentName} (${report.student})`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"ReportDetailsDate\",\n              children: `Sent on ${formattedDate}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"ReportDetailsTitle\",\n              children: `Title: ${report.title}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"ReportDetailsContent\",\n            children: report.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ReportDetailsFooter\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `ReportFileDownloadButton`,\n              disabled: !report.file,\n              onClick: () => downloadFile(report.file),\n              children: \"Download File\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"ReportFileDownloadLabel\",\n              children: currentFile ? currentFile.filename : 'No attachment'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_s(ReportPopUp, \"l9RlhsOzEUa7MQvzm8rp40aPiXU=\");\n_c = ReportPopUp;\nexport default ReportPopUp;\nvar _c;\n$RefreshReg$(_c, \"ReportPopUp\");","map":{"version":3,"names":["formatDate","axios","React","useState","useEffect","jsxDEV","_jsxDEV","ReportPopUp","studentName","report","isVisible","closeFunction","_s","UPLOADS_URL","currentFile","setCurrentFile","controller","AbortController","fetchFile","fileId","response","get","signal","data","file","error","isCancel","console","abort","downloadFile","responseType","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","headers","split","body","appendChild","click","removeChild","formattedDate","createdAt","className","id","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","student","title","text","disabled","filename","_c","$RefreshReg$"],"sources":["/Users/fawwazhaziq/Downloads/SEProject-v3/SEProject/frontend/src/components/ReportPopUp.js"],"sourcesContent":["import './styling/ReportPopUp.css';\r\nimport {formatDate} from '../utils/FormatDate';\r\nimport axios from 'axios';\r\nimport React, {useState, useEffect} from 'react';\r\n\r\nconst ReportPopUp = ({studentName, report, isVisible, closeFunction}) => {\r\n\r\n  const UPLOADS_URL = '/api/uploads';\r\n  \r\n  const [currentFile, setCurrentFile] = useState(null);\r\n  \r\n  useEffect(() => {\r\n    const controller = new AbortController();\r\n\r\n    const fetchFile = async (fileId) => {\r\n      try {\r\n        const response = await axios.get(`${UPLOADS_URL}/${fileId}`, {\r\n            signal: controller.signal,\r\n        });\r\n        setCurrentFile(response.data.file);\r\n      } catch (error) {\r\n        if (axios.isCancel(error)) {\r\n            console.error(`Fetch file request cancelled`);\r\n        }\r\n        else {\r\n            console.error(`Error getting file:` , error);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (report.file) {\r\n      fetchFile(report.file);\r\n    }\r\n    else {\r\n      setCurrentFile(null);\r\n    }\r\n\r\n    return () => {\r\n      controller.abort();\r\n    };\r\n  }, [report]);\r\n\r\n  const downloadFile = async (fileId) => {\r\n    try {\r\n      const response = await axios.get(`${UPLOADS_URL}/download/${fileId}`, {\r\n        responseType: 'blob',\r\n      });\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.setAttribute('download', response.headers['content-disposition'].split('=')[1]);\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } catch (error) {\r\n      console.error('Error downloading file: ', error);\r\n    }\r\n  };\r\n\r\n  const formattedDate = formatDate(report.createdAt);\r\n\r\n  return (\r\n    <div className = {`ReportOverlay ${isVisible ? 'visible' : 'hidden'}`} id = \"reportOverlay\">\r\n        <div className = \"PopUp\" id = \"popup\">\r\n          <button className = \"PopUpExitButton\"\r\n                  id = \"popUpExitButton\"\r\n                  onClick = {() => closeFunction()}\r\n                  >\r\n            X\r\n          </button>\r\n          <div className = \"ReportWrapper\">\r\n            <div className = 'ReportDetails'>\r\n              <div className = 'ReportDetailsHeader'>\r\n                <label className = 'ReportDetailsSender'>\r\n                  {`Progress report sent by ${studentName} (${report.student})`}\r\n                </label>\r\n                <label className = 'ReportDetailsDate'>\r\n                  {`Sent on ${formattedDate}`}\r\n                </label>\r\n                <label className = 'ReportDetailsTitle'>\r\n                  {`Title: ${report.title}`}\r\n                </label>\r\n              </div>\r\n              <p className = 'ReportDetailsContent'>\r\n                {report.text}\r\n              </p>\r\n              <div className = 'ReportDetailsFooter'>\r\n                <button \r\n                  className = {`ReportFileDownloadButton`}\r\n                  disabled = {!report.file}\r\n                  onClick = {() => downloadFile(report.file)}>\r\n                    Download File\r\n                </button>\r\n                <label className = 'ReportFileDownloadLabel'>\r\n                  {currentFile ? (currentFile.filename) : 'No attachment'}\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default ReportPopUp;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}